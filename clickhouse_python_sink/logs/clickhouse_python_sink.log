2022-07-28 19:59:14 INFO [scheduler:29] [MainThread] boot_strap start
2022-07-28 19:59:14 INFO [scheduler:41] [MainThread] data_sum_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  sum(rows) AS total_num FROM system.parts WHERE table IN ('trips','trips_np') "  
2022-07-28 19:59:14 INFO [scheduler:85] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select toYYYYMM(pickup_date) as part,count(1) as count FROM default.trips  where toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510 group by toYYYYMM(pickup_date) order by toYYYYMM(pickup_date);" --format JSON 
2022-07-28 19:59:14 INFO [scheduler:100] [MainThread] partition 201507 start split
2022-07-28 19:59:14 INFO [scheduler:130] [MainThread]  /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  round(dateDiff('second', min(pickup_date), max(pickup_date))/(count(1)/200000),0) as step_length_sec ,round((count(1)/200000),0) as bath_num,min(pickup_date) as min_value,max(pickup_date) as  max_value FROM default.trips  where toYYYYMM(pickup_date)='201507' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510 ;"  --format JSON 
2022-07-28 19:59:14 INFO [scheduler:147] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 1344255, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201507' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 19:59:14 INFO [scheduler:153] [MainThread] ['2015-07-01', '2015-07-16', '2015-07-31']
2022-07-28 19:59:14 INFO [scheduler:165] [MainThread]  pickup_date>='2015-07-01'  and  pickup_date<'2015-07-16' 
2022-07-28 19:59:14 INFO [scheduler:165] [MainThread]  pickup_date>='2015-07-16'  and  pickup_date<='2015-07-31' 
2022-07-28 19:59:14 INFO [scheduler:19] [ThreadPoolExecutor-0_0] pipeline [{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 179393, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201507\' and  pickup_date>=\'2015-07-01\'  and  pickup_date<\'2015-07-16\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201507_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 206248, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201507\' and  pickup_date>=\'2015-07-16\'  and  pickup_date<=\'2015-07-31\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201507_1'}] start.....
2022-07-28 19:59:14 INFO [scheduler:113] [MainThread] boot_strap started,process_backend:<function process_backend at 0x10ad539d0> task_set:[{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 179393, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201507\' and  pickup_date>=\'2015-07-01\'  and  pickup_date<\'2015-07-16\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201507_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 206248, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201507\' and  pickup_date>=\'2015-07-16\'  and  pickup_date<=\'2015-07-31\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201507_1'}] 
2022-07-28 19:59:14 ERROR [scheduler:24] [ThreadPoolExecutor-0_0] 'ThreadPoolExecutor' object is not callable
Traceback (most recent call last):
  File "/Users/alex/Documents/dev/code/flywheel/clickhouse_export/clickhouse_python_sink/scheduler.py", line 20, in process_backend
    executor_object = executor()
TypeError: 'ThreadPoolExecutor' object is not callable
2022-07-28 19:59:14 INFO [scheduler:100] [MainThread] partition 201508 start split
2022-07-28 19:59:14 INFO [scheduler:130] [MainThread]  /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  round(dateDiff('second', min(pickup_date), max(pickup_date))/(count(1)/200000),0) as step_length_sec ,round((count(1)/200000),0) as bath_num,min(pickup_date) as min_value,max(pickup_date) as  max_value FROM default.trips  where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510 ;"  --format JSON 
2022-07-28 19:59:14 INFO [scheduler:147] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 465673, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 19:59:15 INFO [scheduler:147] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 931346, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 19:59:15 INFO [scheduler:147] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 1397019, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 19:59:15 INFO [scheduler:147] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 1862692, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 19:59:15 INFO [scheduler:147] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 2328365, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 19:59:15 INFO [scheduler:153] [MainThread] ['2015-08-01', '2015-08-06', '2015-08-11', '2015-08-17', '2015-08-22', '2015-08-27', '2015-08-31']
2022-07-28 19:59:15 INFO [scheduler:165] [MainThread]  pickup_date>='2015-08-01'  and  pickup_date<'2015-08-06' 
2022-07-28 19:59:15 INFO [scheduler:165] [MainThread]  pickup_date>='2015-08-06'  and  pickup_date<'2015-08-11' 
2022-07-28 19:59:15 INFO [scheduler:165] [MainThread]  pickup_date>='2015-08-11'  and  pickup_date<'2015-08-17' 
2022-07-28 19:59:15 INFO [scheduler:165] [MainThread]  pickup_date>='2015-08-17'  and  pickup_date<'2015-08-22' 
2022-07-28 19:59:15 INFO [scheduler:165] [MainThread]  pickup_date>='2015-08-22'  and  pickup_date<'2015-08-27' 
2022-07-28 19:59:15 INFO [scheduler:165] [MainThread]  pickup_date>='2015-08-27'  and  pickup_date<='2015-08-31' 
2022-07-28 19:59:15 INFO [scheduler:113] [MainThread] boot_strap started,process_backend:<function process_backend at 0x10ad539d0> task_set:[{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 185322, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-01\'  and  pickup_date<\'2015-08-06\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 178359, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-06\'  and  pickup_date<\'2015-08-11\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_1'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 218758, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-11\'  and  pickup_date<\'2015-08-17\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_2'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 185713, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-17\'  and  pickup_date<\'2015-08-22\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_3'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 169871, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-22\'  and  pickup_date<\'2015-08-27\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_4'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 175205, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-27\'  and  pickup_date<=\'2015-08-31\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_5'}] 
2022-07-28 19:59:15 INFO [scheduler:19] [ThreadPoolExecutor-0_0] pipeline [{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 185322, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-01\'  and  pickup_date<\'2015-08-06\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 178359, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-06\'  and  pickup_date<\'2015-08-11\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_1'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 218758, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-11\'  and  pickup_date<\'2015-08-17\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_2'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 185713, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-17\'  and  pickup_date<\'2015-08-22\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_3'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 169871, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-22\'  and  pickup_date<\'2015-08-27\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_4'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 175205, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-27\'  and  pickup_date<=\'2015-08-31\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_5'}] start.....
2022-07-28 19:59:15 INFO [scheduler:100] [MainThread] partition 201509 start split
2022-07-28 19:59:15 ERROR [scheduler:24] [ThreadPoolExecutor-0_0] 'ThreadPoolExecutor' object is not callable
Traceback (most recent call last):
  File "/Users/alex/Documents/dev/code/flywheel/clickhouse_export/clickhouse_python_sink/scheduler.py", line 20, in process_backend
    executor_object = executor()
TypeError: 'ThreadPoolExecutor' object is not callable
2022-07-28 19:59:15 INFO [scheduler:130] [MainThread]  /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  round(dateDiff('second', min(pickup_date), max(pickup_date))/(count(1)/200000),0) as step_length_sec ,round((count(1)/200000),0) as bath_num,min(pickup_date) as min_value,max(pickup_date) as  max_value FROM default.trips  where toYYYYMM(pickup_date)='201509' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510 ;"  --format JSON 
2022-07-28 19:59:15 INFO [scheduler:147] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 1000663, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201509' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 19:59:15 INFO [scheduler:147] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 2001326, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201509' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 19:59:16 INFO [scheduler:153] [MainThread] ['2015-09-01', '2015-09-12', '2015-09-24', '2015-09-30']
2022-07-28 19:59:16 INFO [scheduler:165] [MainThread]  pickup_date>='2015-09-01'  and  pickup_date<'2015-09-12' 
2022-07-28 19:59:16 INFO [scheduler:165] [MainThread]  pickup_date>='2015-09-12'  and  pickup_date<'2015-09-24' 
2022-07-28 19:59:16 INFO [scheduler:165] [MainThread]  pickup_date>='2015-09-24'  and  pickup_date<='2015-09-30' 
2022-07-28 19:59:16 INFO [scheduler:113] [MainThread] boot_strap started,process_backend:<function process_backend at 0x10ad539d0> task_set:[{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 176703, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-01\'  and  pickup_date<\'2015-09-12\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 209787, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-12\'  and  pickup_date<\'2015-09-24\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_1'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 114298, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-24\'  and  pickup_date<=\'2015-09-30\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_2'}] 
2022-07-28 19:59:16 INFO [scheduler:19] [ThreadPoolExecutor-0_0] pipeline [{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 176703, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-01\'  and  pickup_date<\'2015-09-12\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 209787, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-12\'  and  pickup_date<\'2015-09-24\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_1'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 114298, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-24\'  and  pickup_date<=\'2015-09-30\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_2'}] start.....
2022-07-28 19:59:16 ERROR [scheduler:24] [ThreadPoolExecutor-0_0] 'ThreadPoolExecutor' object is not callable
Traceback (most recent call last):
  File "/Users/alex/Documents/dev/code/flywheel/clickhouse_export/clickhouse_python_sink/scheduler.py", line 20, in process_backend
    executor_object = executor()
TypeError: 'ThreadPoolExecutor' object is not callable
2022-07-28 19:59:16 INFO [scheduler:78] [MainThread] boot_strap started,process_backend:<function process_backend at 0x10ad539d0> task_set:[{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np', 'data_rows': 1000, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips_np INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv\', \'CSVWithNames\');"', 'task_id': 'trips_np'}] 
2022-07-28 19:59:16 INFO [scheduler:19] [ThreadPoolExecutor-0_0] pipeline [{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np', 'data_rows': 1000, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips_np INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv\', \'CSVWithNames\');"', 'task_id': 'trips_np'}] start.....
2022-07-28 19:59:16 ERROR [scheduler:24] [ThreadPoolExecutor-0_0] 'ThreadPoolExecutor' object is not callable
Traceback (most recent call last):
  File "/Users/alex/Documents/dev/code/flywheel/clickhouse_export/clickhouse_python_sink/scheduler.py", line 20, in process_backend
    executor_object = executor()
TypeError: 'ThreadPoolExecutor' object is not callable
2022-07-28 20:00:41 INFO [scheduler:30] [MainThread] boot_strap start
2022-07-28 20:00:41 INFO [scheduler:42] [MainThread] data_sum_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  sum(rows) AS total_num FROM system.parts WHERE table IN ('trips','trips_np') "  
2022-07-28 20:00:41 INFO [scheduler:86] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select toYYYYMM(pickup_date) as part,count(1) as count FROM default.trips  where toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510 group by toYYYYMM(pickup_date) order by toYYYYMM(pickup_date);" --format JSON 
2022-07-28 20:00:41 INFO [scheduler:101] [MainThread] partition 201507 start split
2022-07-28 20:00:41 INFO [scheduler:131] [MainThread]  /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  round(dateDiff('second', min(pickup_date), max(pickup_date))/(count(1)/200000),0) as step_length_sec ,round((count(1)/200000),0) as bath_num,min(pickup_date) as min_value,max(pickup_date) as  max_value FROM default.trips  where toYYYYMM(pickup_date)='201507' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510 ;"  --format JSON 
2022-07-28 20:00:41 INFO [scheduler:148] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 1344255, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201507' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 20:00:41 INFO [scheduler:154] [MainThread] ['2015-07-01', '2015-07-16', '2015-07-31']
2022-07-28 20:00:41 INFO [scheduler:166] [MainThread]  pickup_date>='2015-07-01'  and  pickup_date<'2015-07-16' 
2022-07-28 20:00:41 INFO [scheduler:166] [MainThread]  pickup_date>='2015-07-16'  and  pickup_date<='2015-07-31' 
2022-07-28 20:00:42 INFO [scheduler:20] [ThreadPoolExecutor-0_0] pipeline [{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 179393, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201507\' and  pickup_date>=\'2015-07-01\'  and  pickup_date<\'2015-07-16\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201507_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 206248, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201507\' and  pickup_date>=\'2015-07-16\'  and  pickup_date<=\'2015-07-31\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201507_1'}] start.....
2022-07-28 20:00:42 INFO [scheduler:114] [MainThread] boot_strap started,process_backend:<function process_backend at 0x108deb8b0> task_set:[{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 179393, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201507\' and  pickup_date>=\'2015-07-01\'  and  pickup_date<\'2015-07-16\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201507_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 206248, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201507\' and  pickup_date>=\'2015-07-16\'  and  pickup_date<=\'2015-07-31\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201507_1'}] 
2022-07-28 20:00:42 INFO [executor:21] [ThreadPoolExecutor-0_0] boot_strap start
2022-07-28 20:00:42 INFO [scheduler:101] [MainThread] partition 201508 start split
2022-07-28 20:00:42 INFO [executor:25] [ThreadPoolExecutor-0_0] run task 
2022-07-28 20:00:42 INFO [scheduler:131] [MainThread]  /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  round(dateDiff('second', min(pickup_date), max(pickup_date))/(count(1)/200000),0) as step_length_sec ,round((count(1)/200000),0) as bath_num,min(pickup_date) as min_value,max(pickup_date) as  max_value FROM default.trips  where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510 ;"  --format JSON 
2022-07-28 20:00:42 INFO [executor:32] [ThreadPoolExecutor-0_0] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:42 INFO [executor:33] [ThreadPoolExecutor-0_0] mkdir_cmd_result: 
2022-07-28 20:00:42 INFO [scheduler:148] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 465673, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 20:00:42 INFO [scheduler:148] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 931346, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 20:00:42 INFO [executor:36] [ThreadPoolExecutor-0_0] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201507' and  pickup_date>='2015-07-01'  and  pickup_date<'2015-07-16'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:42 INFO [executor:37] [ThreadPoolExecutor-0_0] export_cmd_result: 
2022-07-28 20:00:42 INFO [scheduler:148] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 1397019, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 20:00:42 INFO [scheduler:148] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 1862692, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 20:00:42 INFO [scheduler:148] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 2328365, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201508' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 20:00:42 INFO [scheduler:154] [MainThread] ['2015-08-01', '2015-08-06', '2015-08-11', '2015-08-17', '2015-08-22', '2015-08-27', '2015-08-31']
2022-07-28 20:00:42 INFO [scheduler:166] [MainThread]  pickup_date>='2015-08-01'  and  pickup_date<'2015-08-06' 
2022-07-28 20:00:42 INFO [scheduler:166] [MainThread]  pickup_date>='2015-08-06'  and  pickup_date<'2015-08-11' 
2022-07-28 20:00:42 INFO [scheduler:166] [MainThread]  pickup_date>='2015-08-11'  and  pickup_date<'2015-08-17' 
2022-07-28 20:00:42 INFO [executor:40] [ThreadPoolExecutor-0_0] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_0.csv', 'CSVWithNames');"
2022-07-28 20:00:42 INFO [executor:41] [ThreadPoolExecutor-0_0] check_cmd_result: 179393
2022-07-28 20:00:42 INFO [executor:43] [ThreadPoolExecutor-0_0] task run success:trips_201507_0 
2022-07-28 20:00:42 INFO [executor:25] [ThreadPoolExecutor-0_0] run task 
2022-07-28 20:00:42 INFO [executor:32] [ThreadPoolExecutor-0_0] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:42 INFO [executor:33] [ThreadPoolExecutor-0_0] mkdir_cmd_result: 
2022-07-28 20:00:42 INFO [scheduler:166] [MainThread]  pickup_date>='2015-08-17'  and  pickup_date<'2015-08-22' 
2022-07-28 20:00:42 INFO [scheduler:166] [MainThread]  pickup_date>='2015-08-22'  and  pickup_date<'2015-08-27' 
2022-07-28 20:00:42 INFO [executor:36] [ThreadPoolExecutor-0_0] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201507' and  pickup_date>='2015-07-16'  and  pickup_date<='2015-07-31'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:42 INFO [executor:37] [ThreadPoolExecutor-0_0] export_cmd_result: 
2022-07-28 20:00:42 INFO [scheduler:166] [MainThread]  pickup_date>='2015-08-27'  and  pickup_date<='2015-08-31' 
2022-07-28 20:00:42 INFO [scheduler:20] [ThreadPoolExecutor-0_1] pipeline [{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 185322, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-01\'  and  pickup_date<\'2015-08-06\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 178359, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-06\'  and  pickup_date<\'2015-08-11\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_1'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 218758, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-11\'  and  pickup_date<\'2015-08-17\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_2'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 185713, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-17\'  and  pickup_date<\'2015-08-22\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_3'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 169871, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-22\'  and  pickup_date<\'2015-08-27\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_4'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 175205, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-27\'  and  pickup_date<=\'2015-08-31\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_5'}] start.....
2022-07-28 20:00:42 INFO [executor:21] [ThreadPoolExecutor-0_1] boot_strap start
2022-07-28 20:00:42 INFO [executor:25] [ThreadPoolExecutor-0_1] run task 
2022-07-28 20:00:42 INFO [scheduler:114] [MainThread] boot_strap started,process_backend:<function process_backend at 0x108deb8b0> task_set:[{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 185322, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-01\'  and  pickup_date<\'2015-08-06\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 178359, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-06\'  and  pickup_date<\'2015-08-11\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_1'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 218758, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-11\'  and  pickup_date<\'2015-08-17\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_2'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 185713, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-17\'  and  pickup_date<\'2015-08-22\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_3'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 169871, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-22\'  and  pickup_date<\'2015-08-27\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_4'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 175205, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201508\' and  pickup_date>=\'2015-08-27\'  and  pickup_date<=\'2015-08-31\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201508_5'}] 
2022-07-28 20:00:42 INFO [scheduler:101] [MainThread] partition 201509 start split
2022-07-28 20:00:42 INFO [scheduler:131] [MainThread]  /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  round(dateDiff('second', min(pickup_date), max(pickup_date))/(count(1)/200000),0) as step_length_sec ,round((count(1)/200000),0) as bath_num,min(pickup_date) as min_value,max(pickup_date) as  max_value FROM default.trips  where toYYYYMM(pickup_date)='201509' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510 ;"  --format JSON 
2022-07-28 20:00:43 INFO [executor:32] [ThreadPoolExecutor-0_1] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:43 INFO [executor:33] [ThreadPoolExecutor-0_1] mkdir_cmd_result: 
2022-07-28 20:00:43 INFO [scheduler:148] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 1000663, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201509' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 20:00:43 INFO [scheduler:148] [MainThread] /Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT  date_add(second, 2001326, min(pickup_date))   FROM default.trips   where toYYYYMM(pickup_date)='201509' and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510" ;
2022-07-28 20:00:43 INFO [executor:36] [ThreadPoolExecutor-0_1] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201508' and  pickup_date>='2015-08-01'  and  pickup_date<'2015-08-06'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:43 INFO [executor:37] [ThreadPoolExecutor-0_1] export_cmd_result: 
2022-07-28 20:00:43 INFO [scheduler:154] [MainThread] ['2015-09-01', '2015-09-12', '2015-09-24', '2015-09-30']
2022-07-28 20:00:43 INFO [scheduler:166] [MainThread]  pickup_date>='2015-09-01'  and  pickup_date<'2015-09-12' 
2022-07-28 20:00:43 INFO [scheduler:166] [MainThread]  pickup_date>='2015-09-12'  and  pickup_date<'2015-09-24' 
2022-07-28 20:00:43 INFO [scheduler:166] [MainThread]  pickup_date>='2015-09-24'  and  pickup_date<='2015-09-30' 
2022-07-28 20:00:43 INFO [executor:40] [ThreadPoolExecutor-0_0] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201507_1.csv', 'CSVWithNames');"
2022-07-28 20:00:43 INFO [executor:41] [ThreadPoolExecutor-0_0] check_cmd_result: 206248
2022-07-28 20:00:43 INFO [executor:43] [ThreadPoolExecutor-0_0] task run success:trips_201507_1 
2022-07-28 20:00:43 INFO [scheduler:114] [MainThread] boot_strap started,process_backend:<function process_backend at 0x108deb8b0> task_set:[{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 176703, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-01\'  and  pickup_date<\'2015-09-12\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 209787, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-12\'  and  pickup_date<\'2015-09-24\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_1'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 114298, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-24\'  and  pickup_date<=\'2015-09-30\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_2'}] 
2022-07-28 20:00:43 INFO [scheduler:20] [ThreadPoolExecutor-0_0] pipeline [{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 176703, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-01\'  and  pickup_date<\'2015-09-12\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_0'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 209787, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-12\'  and  pickup_date<\'2015-09-24\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_1'}, {'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips', 'data_rows': 114298, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)=\'201509\' and  pickup_date>=\'2015-09-24\'  and  pickup_date<=\'2015-09-30\'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv\', \'CSVWithNames\');"', 'task_id': 'trips_201509_2'}] start.....
2022-07-28 20:00:43 INFO [executor:21] [ThreadPoolExecutor-0_0] boot_strap start
2022-07-28 20:00:43 INFO [executor:25] [ThreadPoolExecutor-0_0] run task 
2022-07-28 20:00:43 INFO [executor:32] [ThreadPoolExecutor-0_0] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:43 INFO [executor:33] [ThreadPoolExecutor-0_0] mkdir_cmd_result: 
2022-07-28 20:00:43 INFO [scheduler:20] [ThreadPoolExecutor-0_2] pipeline [{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np', 'data_rows': 1000, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips_np INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv\', \'CSVWithNames\');"', 'task_id': 'trips_np'}] start.....
2022-07-28 20:00:43 INFO [scheduler:79] [MainThread] boot_strap started,process_backend:<function process_backend at 0x108deb8b0> task_set:[{'mkdir_cmd': 'mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np', 'data_rows': 1000, 'export_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips_np INTO OUTFILE \'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv\' FORMAT CSVWithNames;"', 'check_cmd': '/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file(\'/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv\', \'CSVWithNames\');"', 'task_id': 'trips_np'}] 
2022-07-28 20:00:43 INFO [executor:21] [ThreadPoolExecutor-0_2] boot_strap start
2022-07-28 20:00:43 INFO [executor:25] [ThreadPoolExecutor-0_2] run task 
2022-07-28 20:00:43 INFO [executor:32] [ThreadPoolExecutor-0_2] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np
2022-07-28 20:00:43 INFO [executor:33] [ThreadPoolExecutor-0_2] mkdir_cmd_result: 
2022-07-28 20:00:43 INFO [executor:36] [ThreadPoolExecutor-0_2] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips_np INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:43 INFO [executor:37] [ThreadPoolExecutor-0_2] export_cmd_result: 
2022-07-28 20:00:43 INFO [executor:36] [ThreadPoolExecutor-0_0] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201509' and  pickup_date>='2015-09-01'  and  pickup_date<'2015-09-12'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:43 INFO [executor:37] [ThreadPoolExecutor-0_0] export_cmd_result: 
2022-07-28 20:00:43 INFO [executor:40] [ThreadPoolExecutor-0_1] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_0.csv', 'CSVWithNames');"
2022-07-28 20:00:43 INFO [executor:41] [ThreadPoolExecutor-0_1] check_cmd_result: 185322
2022-07-28 20:00:43 INFO [executor:43] [ThreadPoolExecutor-0_1] task run success:trips_201508_0 
2022-07-28 20:00:43 INFO [executor:25] [ThreadPoolExecutor-0_1] run task 
2022-07-28 20:00:43 INFO [executor:32] [ThreadPoolExecutor-0_1] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:43 INFO [executor:33] [ThreadPoolExecutor-0_1] mkdir_cmd_result: 
2022-07-28 20:00:43 INFO [executor:40] [ThreadPoolExecutor-0_2] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips_np/trips_np.csv', 'CSVWithNames');"
2022-07-28 20:00:43 INFO [executor:41] [ThreadPoolExecutor-0_2] check_cmd_result: 1000
2022-07-28 20:00:43 INFO [executor:43] [ThreadPoolExecutor-0_2] task run success:trips_np 
2022-07-28 20:00:43 INFO [executor:36] [ThreadPoolExecutor-0_1] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201508' and  pickup_date>='2015-08-06'  and  pickup_date<'2015-08-11'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:43 INFO [executor:37] [ThreadPoolExecutor-0_1] export_cmd_result: 
2022-07-28 20:00:44 INFO [executor:40] [ThreadPoolExecutor-0_0] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_0.csv', 'CSVWithNames');"
2022-07-28 20:00:44 INFO [executor:41] [ThreadPoolExecutor-0_0] check_cmd_result: 176703
2022-07-28 20:00:44 INFO [executor:43] [ThreadPoolExecutor-0_0] task run success:trips_201509_0 
2022-07-28 20:00:44 INFO [executor:25] [ThreadPoolExecutor-0_0] run task 
2022-07-28 20:00:44 INFO [executor:32] [ThreadPoolExecutor-0_0] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:44 INFO [executor:33] [ThreadPoolExecutor-0_0] mkdir_cmd_result: 
2022-07-28 20:00:44 INFO [executor:36] [ThreadPoolExecutor-0_0] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201509' and  pickup_date>='2015-09-12'  and  pickup_date<'2015-09-24'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:44 INFO [executor:37] [ThreadPoolExecutor-0_0] export_cmd_result: 
2022-07-28 20:00:44 INFO [executor:40] [ThreadPoolExecutor-0_1] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_1.csv', 'CSVWithNames');"
2022-07-28 20:00:44 INFO [executor:41] [ThreadPoolExecutor-0_1] check_cmd_result: 178359
2022-07-28 20:00:44 INFO [executor:43] [ThreadPoolExecutor-0_1] task run success:trips_201508_1 
2022-07-28 20:00:44 INFO [executor:25] [ThreadPoolExecutor-0_1] run task 
2022-07-28 20:00:44 INFO [executor:32] [ThreadPoolExecutor-0_1] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:44 INFO [executor:33] [ThreadPoolExecutor-0_1] mkdir_cmd_result: 
2022-07-28 20:00:44 INFO [executor:36] [ThreadPoolExecutor-0_1] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201508' and  pickup_date>='2015-08-11'  and  pickup_date<'2015-08-17'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:44 INFO [executor:37] [ThreadPoolExecutor-0_1] export_cmd_result: 
2022-07-28 20:00:44 INFO [executor:40] [ThreadPoolExecutor-0_0] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_1.csv', 'CSVWithNames');"
2022-07-28 20:00:44 INFO [executor:41] [ThreadPoolExecutor-0_0] check_cmd_result: 209787
2022-07-28 20:00:44 INFO [executor:43] [ThreadPoolExecutor-0_0] task run success:trips_201509_1 
2022-07-28 20:00:44 INFO [executor:25] [ThreadPoolExecutor-0_0] run task 
2022-07-28 20:00:44 INFO [executor:32] [ThreadPoolExecutor-0_0] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:44 INFO [executor:33] [ThreadPoolExecutor-0_0] mkdir_cmd_result: 
2022-07-28 20:00:44 INFO [executor:36] [ThreadPoolExecutor-0_0] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201509' and  pickup_date>='2015-09-24'  and  pickup_date<='2015-09-30'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:44 INFO [executor:37] [ThreadPoolExecutor-0_0] export_cmd_result: 
2022-07-28 20:00:44 INFO [executor:40] [ThreadPoolExecutor-0_1] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_2.csv', 'CSVWithNames');"
2022-07-28 20:00:44 INFO [executor:41] [ThreadPoolExecutor-0_1] check_cmd_result: 218758
2022-07-28 20:00:44 INFO [executor:43] [ThreadPoolExecutor-0_1] task run success:trips_201508_2 
2022-07-28 20:00:44 INFO [executor:25] [ThreadPoolExecutor-0_1] run task 
2022-07-28 20:00:44 INFO [executor:32] [ThreadPoolExecutor-0_1] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:44 INFO [executor:33] [ThreadPoolExecutor-0_1] mkdir_cmd_result: 
2022-07-28 20:00:45 INFO [executor:36] [ThreadPoolExecutor-0_1] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201508' and  pickup_date>='2015-08-17'  and  pickup_date<'2015-08-22'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:45 INFO [executor:37] [ThreadPoolExecutor-0_1] export_cmd_result: 
2022-07-28 20:00:45 INFO [executor:40] [ThreadPoolExecutor-0_0] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201509_2.csv', 'CSVWithNames');"
2022-07-28 20:00:45 INFO [executor:41] [ThreadPoolExecutor-0_0] check_cmd_result: 114298
2022-07-28 20:00:45 INFO [executor:43] [ThreadPoolExecutor-0_0] task run success:trips_201509_2 
2022-07-28 20:00:45 INFO [executor:40] [ThreadPoolExecutor-0_1] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_3.csv', 'CSVWithNames');"
2022-07-28 20:00:45 INFO [executor:41] [ThreadPoolExecutor-0_1] check_cmd_result: 185713
2022-07-28 20:00:45 INFO [executor:43] [ThreadPoolExecutor-0_1] task run success:trips_201508_3 
2022-07-28 20:00:45 INFO [executor:25] [ThreadPoolExecutor-0_1] run task 
2022-07-28 20:00:45 INFO [executor:32] [ThreadPoolExecutor-0_1] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:45 INFO [executor:33] [ThreadPoolExecutor-0_1] mkdir_cmd_result: 
2022-07-28 20:00:45 INFO [executor:36] [ThreadPoolExecutor-0_1] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201508' and  pickup_date>='2015-08-22'  and  pickup_date<'2015-08-27'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:45 INFO [executor:37] [ThreadPoolExecutor-0_1] export_cmd_result: 
2022-07-28 20:00:46 INFO [executor:40] [ThreadPoolExecutor-0_1] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_4.csv', 'CSVWithNames');"
2022-07-28 20:00:46 INFO [executor:41] [ThreadPoolExecutor-0_1] check_cmd_result: 169871
2022-07-28 20:00:46 INFO [executor:43] [ThreadPoolExecutor-0_1] task run success:trips_201508_4 
2022-07-28 20:00:46 INFO [executor:25] [ThreadPoolExecutor-0_1] run task 
2022-07-28 20:00:46 INFO [executor:32] [ThreadPoolExecutor-0_1] mkdir_cmd :mkdir -p /Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips
2022-07-28 20:00:46 INFO [executor:33] [ThreadPoolExecutor-0_1] mkdir_cmd_result: 
2022-07-28 20:00:46 INFO [executor:36] [ThreadPoolExecutor-0_1] export_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="select * FROM default.trips  where toYYYYMM(pickup_date)='201508' and  pickup_date>='2015-08-27'  and  pickup_date<='2015-08-31'  and toYYYYMM(pickup_date)>=201501 and toYYYYMM(pickup_date)<=201510  INTO OUTFILE '/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv' FORMAT CSVWithNames;"
2022-07-28 20:00:46 INFO [executor:37] [ThreadPoolExecutor-0_1] export_cmd_result: 
2022-07-28 20:00:46 INFO [executor:40] [ThreadPoolExecutor-0_1] check_cmd :/Users/alex/Documents/dev/evn/clickhouse/clickhouse  --client --host=127.0.0.1 --port=9000  --query="SELECT count(1) FROM file('/Users/alex/Documents/dev/evn/clickhouse/user_files/default/trips/trips_201508_5.csv', 'CSVWithNames');"
2022-07-28 20:00:46 INFO [executor:41] [ThreadPoolExecutor-0_1] check_cmd_result: 175205
2022-07-28 20:00:46 INFO [executor:43] [ThreadPoolExecutor-0_1] task run success:trips_201508_5 
